name = "cloudmake-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Workers configuration
workers_dev = true
compatibility_flags = ["nodejs_compat"]

# Observability
observability = { enabled = true }

# Routes
[env.development]
name = "cloudmake-api-dev"
vars = { ENVIRONMENT = "development", LOG_LEVEL = "debug" }
route = { pattern = "api-dev.cloudmake.dev/*", zone_name = "cloudmake.dev" }

[env.development.limits]
cpu_ms = 50

[env.staging]
name = "cloudmake-api-staging"
vars = { ENVIRONMENT = "staging", LOG_LEVEL = "info" }
route = { pattern = "api-staging.cloudmake.dev/*", zone_name = "cloudmake.dev" }

[env.staging.limits]
cpu_ms = 50

[env.production]
name = "cloudmake-api-prod"
vars = { ENVIRONMENT = "production", LOG_LEVEL = "warn" }
route = { pattern = "api.cloudmake.dev/*", zone_name = "cloudmake.dev" }

[env.production.limits]
cpu_ms = 50

# Build configuration
[build]
command = "pnpm build"

# Development settings
[dev]
ip = "0.0.0.0"
port = 8787
local_protocol = "http"
